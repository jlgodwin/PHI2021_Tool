rm(list=ls())
library(tidyverse)
library(leaflet)
library(plotly)
library(dplyr)
library(sp)
library(rgdal)
library(geojsonio)
library(shiny)
library(shinyjs)
library(shinydashboard)
library(shinyWidgets)
library(shinycssloaders)
library(shinyBS)
library(sf)
source("./00_utils.R")

# Updated as of 9.9
ui <- dashboardPage(
  title = "Exploring King County",
  
  header = dashboardHeader(
    title = "Exploring King County",
    titleWidth = 330
  ),
  
  dashboardSidebar(
    sidebarMenu(
      menuItem(
        "Project Overview",
        tabName = "intro"
        # icon = icon("dashboard")
      ),
      menuItem(
        "Interactive Forecast Map",
        tabName = "viz_tab"
        # icon = icon("dashboard")
      ),
      menuItem(
        "User Guide",
        tabName = "guide_tab"
      ),
      menuItem(
        "Acknowledgement",
        tabName = "ack"
        # icon = icon("dashboard")
      )
    ),
    
    br(),
    br(),
    
    div(
      id = "attr_info",
      
      tags$style(type='text/css', ".linked_text:hover { text-decoration: underline !important; }"),
      
      hr(
        style="border-top: 1px solid #5c6367;"
      ),
      HTML("For more information contact:<br><a class='linked_text' href='mailto:csde@uw.edu'>csde@uw.edu</a>"),
      br(),
      br(),
      HTML("Funding for this project provided by: <br> <ul style='list-style-position: outside; padding-inline-start: 20px; padding-inline-end: 15px;'><li style='font-size:13px !important;'><a class='linked_text' target='_blank' href='https://www.washington.edu/populationhealth/'>UW Population Health Initiative</a></li><li style='font-size:13px !important;'><a class='linked_text' target='_blank' href='https://csde.washington.edu'>Center for Studies in Demography & Ecology</a></li></ul>"),
      br(),
      
      hr(
        style="border-top: 1px solid #5c6367;"
      ),
      div(
        style="width:230px;padding-bottom:10px;",
        img(
          src = "uw_logo.png",
          height = "45px",
          style = "position: relative;"
        ),
        
        img(
          src = "csde_logo.gif",
          height = "50px",
          style = "position: relative;"
        )
      ),
      
      HTML(
        "<i style='position:relative; font-size:12px; bottom:0px; width:230px; height: 210px; padding: 0px 30px 12px 0px;'><a class='linked_text' target='_blank' href='https://csde.washington.edu'>CSDE</a> acknowledges we are on Coast Salish territory, the traditional homeland of the Duwamish, Suquamish, Tulalip, and Muckleshoot nations and other Native peoples.<br><a class='linked_text' target='_blank' href='https://csde.washington.edu'>CSDE</a>â€™s commissioned logo from Native artist, UW Professor Marvin Oliver acknowledges these vital connections to native peoples and territories.</i>"
      )
    ),
    
    
    collapsed = FALSE
  ),
  
  dashboardBody(
    tags$head(
      tags$link(rel = "stylesheet", type = "text/css", href = "custom.css")
    ),
    
    tags$script(HTML("
        var openTab = function(tabName){
          $('a', $('.sidebar')).each(function() {
            if(this.getAttribute('data-value') == tabName) {
              this.click()
            };
          });
        }
      ")),
    
    tabItems(
      # Introduction tab ####
      tabItem(
        tabName = "intro",
        
        tags$style(type='text/css', "p {font-size: 16px !important} li {font-size: 16px !important}"),
        
        h1(
          HTML("<b>Exploring King County</b>"),
          br(),
          align = "left"
        ),
        h2(
          HTML("Our Population & Households"),
          align = "left"
        ),
        br(),
        
        h2(
          HTML("Project Overview"),
          align = "left"
        ),
        
        p(HTML("<b>Population & Housing Trends in King County:</b>"),
          br(),
          HTML("Growth and Vulnerabilities")),
        br(),
        
        p(HTML("For an overview of our project, download this <a target='_blank' href='./ARFP_2023_Presentation.pdf'>slide deck</a>.",
               "For more information about our work, please read our technical report. You can find the legacy tool",
               "and documentation for the population projections to 2045 developed by the 2020 PHI Applied Research Fellows at " ,
               "https://rsc.csde.washington.edu/kc_forecast_2045/."#,
               #"Visit our <a class='clickable_text' onclick='openTab(\"guide_tab\");' style='cursor:pointer;'>User Guide</a> for directions on using our <a class='clickable_text' onclick='openTab(\"viz_tab\");' style='cursor:pointer;'>interactive map</a>."
        )),
        br(),
        
        p(HTML("Please contact <a target='_blank' href='mailto:csde@uw.edu'>csde@uw.edu</a> if you have any questions."))
        
      ),
      
      # Interactive Visualization tab
      tabItem(
        tabName = "viz_tab",
        
        # use shinyjs to control the loading page
        useShinyjs(),
        
        # show loading page first when loading the data
        div(
          id = "initializing_page",
          div(
            h1("Initializing", align = "center"),
            br(),
            br(),
            div(addSpinner(div(), spin = "circle", color = "black"))
          )
        ),
        
        # the actual visualization tool page is hidden when the data are not loaded
        hidden(
          div(
            id = "main_content",
            
            tags$head(tags$style("#warning{color: red;
                                 font-size: 20px;
                                 font-style: bold;
                                 }"
            )
            ),
            
            # warning text for selecting "Prevalence" and the whole population, since the result would always be 100%
            textOutput("warning"),
            
            singleton(tags$head(tags$script(src = "pop_patch.js"))),
            tags$style(".tooltip{width: 200px; font-size: 14px; }"),
            
            fluidRow(
              #----------viz------
              
              ## Map Column ####
              column(
                width = 8,
                
                tabBox(
                  width = NULL,
                  height = 560,
                  
                  # tab for the map ####
                  tabPanel(
                    # loading spinner when loading new data based on user input
                    shinyjs::useShinyjs(),
                    shinyjs::hidden(div(id = 'loading', style = "position: absolute; left: 50%; top: 240px; z-index: 1000;", addSpinner(div(), spin = "circle", color = "black"))),
                    
                    title = "Map",
                    id = "map_tab",
                    
                    leafletOutput(
                      "map",
                      height = 500
                    )
                    
                  ),
                  
                  # tab for the data attriubtion info ####
                  tabPanel(
                    title = "Data Attribution",
                    id = "data_attribution_tab",
                    
                    tags$style(type='text/css', "li {font-size: 15px !important}"),
                    
                    tags$h3("Data and Resources Used for Creating the Map:"),
                    tags$ul(
                      tags$li(HTML("<a target='_blank' href='https://gis-kingcounty.opendata.arcgis.com/datasets/2010-census-tracts-for-king-county-conflated-to-parcels-major-waterbodies-erased-tracts10-shore-area'>2010 Census Tracts Data by King County GIS Open Data</a>")),
                      tags$li("2010 Health Reporting Area (HRA) data by King County Public Health"),
                      tags$li(HTML("<a target='_blank' href='https://gis-kingcounty.opendata.arcgis.com/datasets/public-health-clinics-ph-clinics-point'>King County Public Health Clinics Data by King County GIS Open Data</a>")),
                      tags$li(HTML("<a target='_blank' href='https://gis-kingcounty.opendata.arcgis.com/datasets/school-sites-in-king-county-schsite-point'>King County School Sites Data by King County GIS Open Data</a>")),
                      tags$li(HTML("The list of Community Health Centers is retrieved from <a target='_blank' href='https://www.kingcounty.gov/depts/health/locations/community-health-centers.aspx'>the King County Public Health website</a>")),
                      tags$li(HTML("The list of Women, Infant and Children Services is retrieved from <a target='_blank' href='https://www.kingcounty.gov/depts/health/locations/wic-first-steps.aspx'>the King County Public Health website</a>")),
                      tags$li("The 2040 Commuter Rail Station, Light Rail Station, and Transit Line data by Puget Sound Regional Council (PSRC)"),
                      tags$li(HTML("<a target='_blank' href='https://icons8.com/icon/18112/hospital'>Hospital icon by Icons8</a>")),
                      tags$li(HTML("<a target='_blank' href='https://icons8.com/icon/18744/school'>School icon by Icons8</a>")),
                      tags$li(HTML("<a target='_blank' href='https://icons8.com/icon/17941/city-railway-station'>City Railway Station icon by Icons8</a>"))
                    )
                  )
                  # end tab for data attrib ####
                ),
                
                # line chart ####
                box(
                  width = NULL,
                  plotlyOutput(
                    "plot",
                    height = 230
                  ),
                  helpText(
                    "* Click on a tract on the map above to see tract/HRA-level population.",
                    br(),
                    "** Click on a name in the legend on the right to show the line for the corresponding race/ethnicity.",
                    br(),
                    "*** \"M\" indicates millions (â€˜000,000s); \"k\" indicates thousands (â€˜000s)."
                  ),
                  
                  uiOutput("reset_chart_button")
                  
                )
                # end line chart ####
              ),
              
              #----------options--------
              column(
                width = 4,
                
                #ARA: Added variable box
                ## Variable Box ####
                box(
                  width = NULL,
                  selectInput(
                    inputId = "var",
                    label = "Variable",
                    choices = c("Population", "Education Level", 
                                "Median Income", "Rent Burden",
                                "Household Size",
                                "Methods of Transportation to Work",
                                "Median Gross Rent", "Number of Bedrooms",
                                "Number of Occupants per Room", "SORL Craigslist Rents",
                                "Environmental Health Disparities"),
                    selected = "Population"
                  )
                ),
                ## Geo Box ####
                conditionalPanel(
                  condition = paste0("input.var != 'Smoothed Household Size'"
                                     , "& input.var != 'Median Income'"
                                     , "& input.var != 'Methods of Transportation to Work'",
                                     "& input.var != 'Number of Occupants per Room'",
                                     "& input.var != 'Number of Bedrooms'",
                                     "& input.var != 'Environmental Health Disparities'"
                  ),
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "geo_level",
                      label = "Geographic Level",
                      choices = c("Census Tract", "Health Reporting Area (HRA)"),
                      selected = "Census Tract"
                    )
                  )
                ),conditionalPanel(
                  condition = paste0("input.var == 'Smoothed Household Size'"
                                     , "| input.var == 'Median Income'"
                                     , "| input.var == 'Methods of Transportation to Work'",
                                     "| input.var == 'Number of Occupants per Room'",
                                     "| input.var == 'Number of Bedrooms'",
                                     "| input.var == 'Environmental Health Disparities'"
                  ),
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "geo_level",
                      label = "Geographic Level",
                      choices = c("Census Tract"),
                      selected = "Census Tract"
                    )
                  )
                ),
                
                # Measure Box ####
                
                conditionalPanel(
                  condition = paste0("input.var != 'Methods of Transportation to Work'"
                                     , "& input.var != 'Median Gross Rent'"
                                     , "& input.var != 'Median Income'",
                                     "& input.var != 'SORL Craigslist Rents'",
                                     "& input.var != 'Environmental Health Disparities'"
                                     ),
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "measure_type_cat",
                      label = "Measure",
                      choices = c("Count", "Prevalence", "Distribution"),
                      selected = "Count"
                    )
                  )
                ),
                
                conditionalPanel(
                  condition = paste0("input.var == 'Methods of Transportation to Work'"
                                     , "| input.var == 'Median Gross Rent'"
                                     , "| input.var == 'Median Income'",
                                     "| input.var == 'SORL Craigslist Rents'"),
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "measure_type_cont",
                      label = "Measure",
                      choices = c("Value"),
                      selected = "Value"
                    )
                  )
                ),
                conditionalPanel(
                  condition = "input.var == 'Environmental Health Disparities'",
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "measure_type_binary",
                      label = "Measure",
                      choices = c("Binary"),
                      selected = "Binary"
                    )
                  )
                ),
                
              

                ## Year Box ####
              

                conditionalPanel(
                  condition = "input.var == 'Household Size'",
                                    box(
                                      width = NULL,

                                      selectInput(
                                        inputId = "year_house_size",
                                        label = "Year",
                                        choices = c("2005-2009", "2010-2014", "2015-2019"),
                                        selected = "2015-2019"
                                      )
                                    )
                ),

                conditionalPanel(
                  condition = "input.var == 'Population'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_pop",
                      label = "Year",
                      choices = paste0(seq(2000,2045,5), "-",
                                       seq(2004,2049,5)),
                      selected = "2015-2019"
                    ),
                    # bstooltip for the helper window
                    bsTooltip(
                      id = "year",
                      title = "<strong>Our population forecasts start from 2020</strong>; population data before 2020 are OFM estimates.",
                      placement = "top",
                      options = list(
                        html = TRUE
                      )
                    )
                  )
                ),

                conditionalPanel(
                  condition = "input.var == `Education Level`",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_edu",
                      label = "Year",
                      choices = paste0(seq(2005,2015,5), "-",
                                       seq(2009,2019,5)),
                      selected = "2015-2019"
                    )
                  )
                ),

                conditionalPanel(
                  condition = "input.var == 'Rent Burden'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_rent_b",
                      label = "Year",
                      choices = paste0(seq(2005,2015,5), "-",
                                       seq(2009,2019,5)),
                      selected = "2015-2019"
                    )
                  )
                ),


                conditionalPanel(
                  condition = "input.var == 'Median Income'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_med_income",
                      label = "Year",
                      choices = paste0(seq(2005,2015,5), "-",
                                       seq(2009,2019,5)),
                      selected = "2019"
                    )
                  )
                
                ),
                conditionalPanel(
                  condition = "input.var == 'Median Gross Rent'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_med_g_rent",
                      label = "Year",
                      choices = c("2005-2009", "2010-2014", "2015-2019"),
                      selected = "2015-2019"
                    )
                  )
                ),
                conditionalPanel(
                  condition ="input.var == 'Number of Occupants per Room'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_occupants",
                      label = "Year",
                      choices = c("2005-2009", "2010-2014", "2015-2019"),
                      selected = "2015-2019"
                    )
                  )
                ),
                conditionalPanel(
                  condition ="input.var == 'Methods of Transportation to Work'",
                  box(
                    width = NULL,

                    selectInput(
                      inputId = "year_methods_of_t",
                      label = "Year",
                      choices = c("2005-2009", "2010-2014", "2015-2019"),
                      selected = "2015-2019"
                    )
                  )
                ),conditionalPanel(
                  condition = "input.var == 'Number of Bedrooms'",
                  box(
                    width = NULL,
                    
                    selectInput(
                      inputId = "year_bed",
                      label = "Year",
                      choices = c("2000", "2002", "2005", "2007", "2010",
                                  "2012", "2015", "2017", "2020"),
                      selected = "2020"
                    )
                  )
                  
                ),
                conditionalPanel(
                  condition = "input.var == 'SORL Craigslist Rents'",
                  box(
                    width = NULL,
                    
                    selectInput(
                      inputId = "year_craigslist",
                      label = "Year",
                      choices = c("2017", "2018", "2019"),
                      selected = "2019"
                    )
                  )
                  
                ),
                conditionalPanel(
                  condition = "input.var == 'Environmental Health Disparities'",
                  box(
                    width = NULL,
                    
                    selectInput(
                      inputId = "year_EHD",
                      label = "Year",
                      choices = c("2023"),
                      selected = "2023"
                    )
                  )
                  
                ),

                
                ### End Year Box ####
                

               ## Sub Groups #### 
                ### Edu Box####
                #ARA_edu: Added Edu 
                conditionalPanel(
                  condition = "input.var == 'Education Level'",
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "edu",
                      label = "Education Level",
                      choices = c("Less than high school diploma", 
                                  "High school graduate (includes equivalency)", 
                                  "Some college or associate's degree",
                                  "Bachelor's degree or higher"),
                      selected = "Less than high school diploma"
                    )
                  )
                ),  
                
                ### Race Box ####
                conditionalPanel(
                  condition = paste0("input.var == 'Education Level'",
                                     "| input.var == 'Population'",
                                     "| input.var == 'Number of Occupants per Room'"),
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "race",
                      label = "Race and Ethnicity",
                      choices = c("All", 
                                  "American Indian and\nAlaska Native (AIAN)",
                                  "Asian", "Black", 
                                  "Hispanic", 
                                  "Native Hawaiian or\nOther Pacific Islander (NHOPI)", 
                                  "Two or More Races", "White"),
                      selected = "All"
                    )
                  )
                ),
                
                ### Burden Box ####
                #JLG: Added Burden box
                conditionalPanel(
                  condition = "input.var == 'Rent Burden'",
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "burden",
                      label = "Burden Level",
                      choices = c("Low Burden", 
                                  "Highly Burdened", 
                                  "Severely Burdened"),
                      selected = "Low Burden"
                    )
                  )
                ), 
                
                ### HH Tenure Box ####
                conditionalPanel(
                  condition = "input.var == 'Household Size'",
                  box(
                    width = NULL,
                    
                    selectInput(
                      inputId = "tenure",
                      label = "Tenure",
                      choices = c("Owner occupied", "Renter occupied"),
                      selected = "Owner occupied"
                    )
                  )
                ),
               
               
               ### Household Size Box ####
               conditionalPanel(
                 condition = "input.var == 'Household Size'",
                 box(
                   width = NULL,
                   selectInput(
                     inputId = "size",
                     label = "Household Size", 
                     choices = paste0(1:7, c(rep("",6), "+")),
                     selected = "1",
                     multiple = FALSE
                   )
                 )
               ),
              
               ### Bedrooms Box ####
               conditionalPanel(
                 condition = "input.var == 'Number of Bedrooms'",
                 box(
                   width = NULL,
                   
                   selectInput(
                     inputId = "bedrooms",
                     label = "Bedrooms",
                     choices = paste0(0:6, c(rep("", 5), "+")),
                     selected = "1",
                     multiple = FALSE
                   )
                 )
               ),
               
               ### Residence Box ####
               conditionalPanel(
                 condition = "input.var == 'Number of Bedrooms'",
                 box(
                   width = NULL,
                   
                   selectInput(
                     inputId = "residence",
                     label = "Residence",
                     choices = c("Duplex", "Single Family", "TownhousePlat",
                                 "Triplex", "Vacant(Single-family)"),
                     selected = "Single Family"
                   )
                 )
               ),
               
               ### Occupants Box ####
               conditionalPanel(
                 condition = "input.var == 'Number of Occupants per Room'",
                 box(
                   width = NULL,
                   
                   selectInput(
                     inputId = "occupants",
                     label = "Occupants per Room",
                     choices = c("One or less occupant per room", 
                                 "More than one occupant per room"),
                     selected = "More than one occupant per room"
                   )
                 )
               ),
                
                ### Transpo Box ####
                conditionalPanel(
                  condition = "input.var == 'Methods of Transportation to Work'",
                  box(
                    width = NULL,
                    selectInput(
                      inputId = "mode_transp",
                      label = "Methods of Transportation",
                      choices = c("Drove Alone", "Carpooled", 
                                  "Public Transportation", "Walked", 
                                  "Taxi/Motorcycle/Bike/Other", 
                                  "Worked from Home"),
                      selected = "Drove Alone"
                      
                    )
                  )
                ),
               
               ### Income Box ####
               conditionalPanel(
                 condition = "input.var == 'Median Income'",
                 box(
                   width = NULL,
                   selectInput(
                     inputId = "median_income",
                     label = "Median Income",
                     choices = c("Median Income"),
                     selected = "Median Income"
                     
                   )
                 )
               ),
               ### Median Gross Rent Box ####
               conditionalPanel(
                 condition = "input.var == 'Median Gross Rent'",
                 box(
                   width = NULL,
                   selectInput(
                     inputId = "median_gross_rent",
                     label = "Median Gross Rent",
                     choices = c("Median Gross Rent"),
                     selected = "Median Gross Rent"

                   )
                 )
               ),
               
               ### Craigslist Box ####
               conditionalPanel(
                 condition = "input.var == 'SORL Craigslist Rents'",
                 box(
                   width = NULL,
                   
                   selectInput(
                     inputId = "craigslist_bedrooms",
                     label = "Bedrooms",
                     choices = paste0(0:4, c(rep("", 4), "+")),
                     selected = "1",
                     multiple = FALSE
                   )
                 )
               ),
               ### Environmental Health Disparities ####
               conditionalPanel(
                 condition = "input.var == 'Environmental Health Disparities'",
                 box(
                   width = NULL,
                   selectInput(
                     inputId = "env_h_dis",
                     label = "Environmental Health Disparities",
                     choices = c("Environmental Health Disparities"),
                     selected = "Environmental Health Disparities"
                     
                   )
                 )
               ),
               
                ### Age Box ####
                conditionalPanel(
                  condition = "input.var == 'Population'",
                  box(
                    width = NULL,
                    
                    sliderTextInput(
                      inputId = "age",
                      label = "Age Range",
                      choices = c(seq(0, 85, 5), "85+"),
                      selected = c("0", "85+"),
                      grid = TRUE
                    ),
               
                
                    tags$head(tags$style("#age_warning{color: red;
                                 font-size: 18px;
                                 font-style: bold;
                                 }")
                    ),
                    
                    textOutput("age_warning"),
                    
                    uiOutput("all_age_button")
                  )
              ),
              
              ### Sex Box ####
              conditionalPanel(
                condition = "input.var == 'Population'",
                box(
                  width = NULL,
                  height = 120,
                  
                  selectInput(
                    inputId = "sex",
                    label = "Sex",
                    choices = c("Female", "Male", "Both"),
                    selected = "Both"
                  )
                )
              ),
              
              )
              ## End Sub Groups ####
            )
            ## End fluidRow
          )
        )
      )
      
    ),
     ## Tab Guide ####
    tabItem(
      tabName = "guide_tab",
      # id = "guide_tab",
      # value = "guide_tab",
      
      h1(
        HTML("User Guide"),
        align = "center"
      ),
      br(),
      p(HTML("The interactive mapping tool can be used to explore anticipated changes in King Countyâ€™s population over time by sex age, race and ethnicity, within census tracts and health reporting areas. For example, this tool allows you to see how King Countyâ€™s population is expected to grow until 2045 if current trends in fertility, mortality, and migration continue. To explore this tool, click the <i>Interactive Map</i> tab on the left side of this page.")),
      br(),
      
      p(HTML("<a target='_blank' href='./docs/uw_forecast_2045_user_guide.pdf'>Click here to view the user guide in PDF</a>")),
    
      
      h3("Limitations"),
      p(HTML("Although population projections aim to provide important estimates for planners, service providers, researchers, and the general public, they are only a reflection of what the population <i>could</i> look like if current population trends continue. They are not determinative of the future. Further, small area projections can be more uncertain and so less predictive than projections for larger areas and populations, and less accurate for the distant future. Like all forecasts, our projections reflect a number of assumptions about expected populations dynamics in King County over the forecast period.")),
      br(),
      
      h3("Methods"),
      p(HTML("The projections presented here use the <a target='_blank' href='https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2822904/'>Hamilton Perry method</a> with smoothing (a variant of the cohort-component method) based on OFMâ€™s 5-year age data by race, ethnicity, and sex at state, county, & tract level for 2015 and 2010. Projections were compared with OFM state-level population projections by sex, age, race and ethnicity from 2020 to 2045 and OFM county-level population projections by sex and age from 2020 to 2045. For more information on the methods and assumptions that are used to create these projections, please refer to the <a target='_blank' href='http://population-dynamics-lab.csde.washington.edu:8080/kc_forecast_2045/docs/uw_forecast_2045_technical_report.pdf'>Technical Report</a>.")),
      br()
      
    ),
    
    
    ## Acknowledgement tab ####
    tabItem(
      tabName = "ack",
      
      h1(
        "Acknowledgements",
        align = "center"
      ),
      br(),
      
      
      p(HTML("This research was funded by the Population Health Initiative at the University of Washington. Partial support for this research also came from Shanahan Endowment Fellowship and a Eunice Kennedy Shriver National Institute of Child Health and Human Development research infrastructure grant, P2C HD042828, to the Center for Studies in Demography & Ecology at the University of Washington."),
        br(),
        br(),
        
        ### Participants ####
        p(
          "This research was supported by the following individuals:",
          tags$ul(
            tags$li("Ali Ahmed"),
            tags$li("Adrien Allorant"),
            tags$li("Will von Geldern"),
            tags$li("Juliette Randazza"),
            tags$li("Grace Rossi"),
            tags$li("Xiaoqi (Steven) Bao"),
            tags$li("Eileen Kazura"),
            tags$li("Jessica Lapham"),
            tags$li("Priya Sarma"),
            tags$li("Crystal Yu"),
            tags$li("Eva Wong"),
            tags$li("Rebeccah Maskin"),
            tags$li("Neal Marquez"),
            tags$li("Christine Leibbrand"),
            tags$li("Jessica Godwin"),
            tags$li("Sara Curran"),
            tags$li("Arti Shah"),
            tags$li("Meher Antia"),
            tags$li("Derek Fulwiler"),
            tags$li("Takashi Inoue"),
            tags$li("Jenna Castillo"),
            tags$li("Takashi Inoue"),
            tags$li("Chris Govella"),
            tags$li("Mary Jewell"),
            tags$li("Oliver Tjalve"),
            tags$li("Maxine Wright"),
            tags$li("Rachel Song"),
            tags$li("Zhaowen Guo"),
            tags$li("Pamela Lim"),
            tags$li("Tiffany Childs"),
            tags$li("Lily Bates")
            
          )
        ),
        
        br(),
        ### Packages ####
        p(
          "The following R packages are used:",
          tags$ul(
            tags$li("tidyverse"),
            tags$li("leaflet"),
            tags$li("plotly"),
            tags$li("dplyr"),
            tags$li("sp"),
            tags$li("rgdal"),
            tags$li("geojsonio"),
            tags$li("shiny"),
            tags$li("shinydashboard"),
            tags$li("shinyWidgets"),
            tags$li("shinycssloaders"),
            tags$li("shinyBS")
          )
        )
        ### End Packages ####
      )
    )
    ## End Acknowledgments ####
  )
)

